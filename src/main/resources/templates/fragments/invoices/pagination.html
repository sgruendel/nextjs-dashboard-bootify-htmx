<!doctype html>

<html xmlns:th="http://www.thymeleaf.org">
  <body>
    <nav th:fragment="pagination" class="d-inline-flex">
      <div
        th:if="${totalItems > 0}"
        class="mr-2 flex items-center justify-center text-xs md:mr-4"
        th:text="${startIndex + '-' + endIndex + ' of ' + totalItems}"
      />

      <ul class="pagination">
        <!--/* left arrow, leave out query param if empty */-->
        <th:block th:if="${#strings.isEmpty(param.query)}">
          <li th:replace="~{:: pagination-arrow ('left', @{/dashboard/invoices(page=${page - 1})}, ${page <= 1})}" />
        </th:block>
        <th:block th:unless="${#strings.isEmpty(param.query)}">
          <li
            th:replace="~{:: pagination-arrow ('left', @{/dashboard/invoices(page=${page - 1}, query=${param.query})}, ${page <= 1})}"
          />
        </th:block>

        <!--/* page numbers, leave out query param if empty */-->
        <th:block th:each="pagination : ${paginations}" th:if="${#strings.isEmpty(param.query)}">
          <li
            th:replace="~{:: pagination-number (${pagination.text}, @{/dashboard/invoices(page=${pagination.text})}, ${pagination.position}, ${#strings.toString(page) == pagination.text})}"
          />
        </th:block>
        <th:block th:each="pagination : ${paginations}" th:unless="${#strings.isEmpty(param.query)}">
          <li
            th:replace="~{:: pagination-number (${pagination.text}, @{/dashboard/invoices(page=${pagination.text}, query=${param.query})}, ${pagination.position}, ${#strings.toString(page) == pagination.text})}"
          />
        </th:block>

        <!--/* right arrow, leave out query param if empty */-->
        <th:block th:if="${#strings.isEmpty(param.query)}">
          <li
            th:replace="~{:: pagination-arrow ('right', @{/dashboard/invoices(page=${page + 1})}, ${page >= totalPages})}"
          />
        </th:block>
        <th:block th:unless="${#strings.isEmpty(param.query)}">
          <li
            th:replace="~{:: pagination-arrow ('right', @{/dashboard/invoices(page=${page + 1}, query=${param.query})}, ${page >= totalPages})}"
          />
        </th:block>
      </ul>
    </nav>

    <li
      th:fragment="pagination-arrow (direction, href, isDisabled)"
      class="page-item"
      th:classappend="${isDisabled}? disabled"
    >
      <a class="page-link" th:href="@{${href}}" th:aria-label="${direction == 'left' ? 'Previous' : 'Next'}">
        <svg
          th:replace="~{fragments/heroicons :: ${direction == 'left' ? 'arrow-left-icon' : 'arrow-right-icon'} ('w-4')}"
        />
      </a>
    </li>

    <!-- TODO get rid of position-->
    <li
      th:fragment="pagination-number (text, href, position, isActive)"
      class="page-item"
      th:classappend="${isActive}? active"
    >
      <a class="page-link" th:href="@{${href}}" th:text="${text}" th:attrappend="aria-current=${isActive}? page">
        <svg
          th:replace="~{fragments/heroicons :: ${direction == 'left' ? 'arrow-left-icon' : 'arrow-right-icon'} ('w-4')}"
        />
      </a>
    </li>
  </body>
</html>
